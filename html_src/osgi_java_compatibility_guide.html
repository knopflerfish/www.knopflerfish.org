<h1 class="kf">Knopflerfish OSGi &amp; Java Compatibility Guide</h1>
<p>
  Knopflerfish as well as Java has evolved over the years and it is
  becoming more and more difficult to get an overview of what
  different version of Knopflerfish, OSGi specifications and Java
  actually work together. This page attempts to make this a bit more clear.
</p>
<h2 class="kf">Knopflerfish Distribution Builds</h2>
<p>
  The table below describes the different Knopflerfish distribution
  builds, what java run-time environments,
  they support, the Java / JDK version the Knopflerfish source code is
  compatible with, and which byte code version the source code is
  compiled into.
</p>
<p>
  In general, the Knopflerfish distributions are always compiled into
  the least Java/JDK version the source code supports. This is to
  support the embedded market where many JVM:s are still on JDK1.6
  level, or even older.
</p>
<p>
  Since all code is upwards compatible Knopflerfish can easily be
  compiled into a more recent version of Java, including Java8. Please
  see the table later on this page presenting javac compatibility issues.
</p>
<p>
<table class="kf">
  <tr>
    <th colspan="6">Knopflerfish Major Distribution Builds, OSGi and Java Version Guide</th>
  </tr>
  <tr>
    <td class="subhead">KF Version</td>
    <td class="subhead">OSGi</td>
    <td class="subhead">JDK</td>
    <td class="subhead">Byte code</td>
    <td class="subhead">Supported Java Run-times</td>
    <td class="subhead">EE</td>
  </tr>

  <tr>
    <td>6.*</td>
    <td>OSGi R6</td>
    <td>1.6</td>
    <td>50</td>
    <td> 1.6+ </td>
    <td>OSGi min 1.2</td>
  </tr>

  <tr>
    <td>5.*</td>
    <td>OSGi R5</td>
    <td>1.4</td>
    <td>48</td>
    <td>
      1.4+ (headless or AWT)<br>
      1.5+ (when using swing based bundles, e.g. desktop)</td>
    <td>OSGi min 1.2</td>
  </tr>

  <tr>
    <td>4.*</td>
    <td>OSGi R4 v4.3</td>
    <td>1.4</td>
    <td>48</td>
    <td>
      1.4+ (headless or AWT)<br>
      1.5+ (when using swing based bundles, e.g. desktop)</td>
    <td>OSGi min 1.2</td>
  </tr>

  <tr>
    <td>3.*</td>
    <td>OSGi R4 v4.2</td>
    <td>1.2</td>
    <td>45</td>
    <td>
      1.2+, PJava 1.2 (headless or AWT)<br>
      1.5+ (when using swing based bundles, e.g. desktop)</td>
    <td>OSGi min 1.2</td>
  </tr>
</table>
</p>
<p> 
A plus-sign after a Java version indicates it supports that version and
higher.
</p>
<p>
  Please also note that some of Knopflerfish utility bundles that are
  uses Swing, e.g. the desktop bundle, do require Java 1.5 or higher. 
</p>

<h2 class="kf">Building Knopflerfish</h2>
<p>
  The table below describes the different Knopflerfish versions and
  which JDK versions can be used to build them.
</p>
<p>
  KF6 is designed to run on Java 1.6 and upwards. To run Knopflerfish on older
  versions of Java KF5 or earlier must be used.
</p>
<p>
  KF6 can be built using Java 1.6 or higher and the byte code generated will be made
  for the tool chain used. E.g. if building KF6 with Java 8 the
  bundles will be built for Java 8 by default.  
</p>  
<p>
  KF5 and KF4 are both designed to run on Java 1.4 and
  upwards. With OSGi R4 v4.3 Java 5 generics were introduced in the OSGi
  APIs. To be able to build a KF distribution that is compatible JDK
  1.4 the the javac flag -target jsr14 is used to remove generics. This has the drawback that such
  compiled .class files can not be used when building on JDK 1.7 since
  support for jsr14 has been removed in Java 7. To
  use Knopflerfish artifacts in a JDK 1.7 based tool chain KF5 must
  therefore be
  built using JDK 1.7. When building KF5 using JDK 1.7 the default is
  to generate Java byte code for JDK 1.5 and upwards which is
  compatible with a JDK 1.7 tool chain.
</p>

<p>
<table class="kf">
  <tr>
    <th colspan="7">Knopflerfish Major Distribution Builds, javac and JDK Version Guide</th>
  </tr>
  <tr>
    <td class="subhead">KF Version</td>
    <td class="subhead">OSGi</td>
    <td class="subhead">KF Source Code</td>
    <td class="subhead">Build Environment</td>
    <td class="subhead">Generates byte code for</td>
    <td class="subhead">Tool Chains<sup>1</sup></td>
    <td class="subhead">Comment</td>
  </tr>

  <tr>
    <td rowspan="3">6.*</td>
    <td rowspan="3">R6</td>
    <td rowspan="3">1.6</td>
    <td>1.6</td>
    <td>JDK 1.6 (50)</td>
    <td>1.6+</td>
    <td>The default is to build for JDK used</td>
  </tr>
  <tr>
    <td>1.7</td>
    <td>JDK 1.7 (51)</td>
    <td>1.7+</td>
    <td>The default is to build for JDK used</td>
  </tr>
  <tr>
    <td>1.8</td>
    <td>JDK 1.8 (52)</td>
    <td>1.8+</td>
    <td>The default is to build for JDK used</td>
  </tr>

  <tr>
    <td rowspan="4">5.*</td>
    <td rowspan="4">R5</td>
    <td rowspan="4">1.5 (1.6)<sup>2</sup></td>
    <td>1.5 - 1.6</td>
    <td>JDK 1.4 (48)</td>
    <td>1.4-1.6</td>
    <td>KF build system default when using JDK 1.5 - 1.6. 
      Generics removed during compilation by using -jsr14 flag</td>
  </tr>
  <tr>
    <td>1.7+</td>
    <td>JDK 1.5 (49)</td>
    <td>1.5+</td>
    <td>KF build system default when using JDK 1.7. Generics are not
      removed and therefore require Java 1.5 or higher</td>
  </tr>

  <tr>
    <td class="optional">1.5 - 1.6</td>
    <td class="optional">JDK 1.5 (49)</td>
    <td class="optional">1.5+</td>
    <td class="optional">
      Supported, but not out of the box. Requires setup changes in the
      KF build system for this build, e.g. modifying the -target
      flag</td>
  </tr>

  <tr>
    <td class="optional">1.7+</td>
    <td class="optional">JDK 1.7 (51)</td>
    <td class="optional">1.7+</td>
    <td class="optional">
      Supported, but not out of the box. Requires setup changes in the
      KF build system for this build, e.g. modifying the -target flag
    </td>
  </tr>

  <tr>
    <td>4.*</td>
    <td>R4 v4.3</td>
    <td>1.5</td>
    <td>1.5 - 1.6</td>
    <td>JDK 1.4 (48)</td>
    <td>1.4 - 1.6</td>
    <td>
      OSGi R4 v4.3 introduced generics in API classes. Generics are
      removed during compilation by using -jsr14 flag
    </td>
  </tr>

  <tr>
    <td>3.*</td>
    <td>R4 v4.2</td>
    <td>1.2</td>
    <td>1.3+</td>
    <td>JDK 1.2 (46)</td>
    <td>1.2+</td>
    <td></td>
  </tr>

</table>

<p>
  <sup>1</sup> Indicates which version of the Java tool chain is
  needed to build third party code and using
  Knopflerfish bundle jars on the build path. 
</p>

<p>
  <sup>2</sup> In KF5 JDK 1.6 annotations recognized by IDEs have been
  introduced. The source code still remain java 1.5 compatible.
</p>

